<!DOCTYPE html>
<html>
<head>
    <title>Cipher SPA</title>
</head>
<body style="background-color: black; color: white; font-family: sans-serif">
<div style="display: flex; align-items: center; width: 100vw">
    <div style="width: 50%; margin: auto; padding-top: 5%">
        <h1>Cipher SPA</h1>
        <label for="msgInput">Enter a value for 'msg':</label>
        <input type="text" id="msgInput">
        <button onclick="executeCipher()">Execute Cipher</button>

        <table id="cipherTable" style="margin-top: 2%">
            <thead>
            <tr>
                <th>Cipher Debug Output</th>
            </tr>
            </thead>
            <tbody id="cipherTableBody">
            </tbody>
        </table>
        <table id="decipherTable" style="margin-top: 2%">
            <thead>
            <tr>
                <th>Decipher Debug Output</th>
            </tr>
            </thead>
            <tbody id="decipherTableBody">
            </tbody>
        </table>
    </div>
</div>
<script>
    function addToDebugTable(tableId, output) {
        const tableBody = document.getElementById(tableId + "Body");
        const newRow = tableBody.insertRow(-1);
        const cell = newRow.insertCell(0);
        cell.innerText = output;
    }

    let asd = [];

    function cipher(msg, debug = false) {
            asd = [...new Set(msg)];
            let i = 1;
            let omega = msg[0];
            let res = '';
            let printout = '-';

            while (i <= msg.length) {
                let k;
                if (i < msg.length) {
                    k = msg[i];
                }
                let omega_k = omega + k;

                if (omega_k in asd) {
                    omega = omega_k;
                } else {
                    let lox = asd.indexOf(omega);
                    printout = lox;
                    res = res + " " + lox;
                    asd.push(omega_k);
                    omega = k;
                }
                i += 1;
                let abc = asd.length - 1
                if (debug) {
                    addToDebugTable("cipherTable", omega + " / " + printout + " / " + abc + ": " + omega_k);
                }
            }

            addToDebugTable("cipherTable", "Cipher Output: " + res);
            return res;
        }

    function decipher(msg, debug = false) {
        let msgArray = msg.split(" "); // Split the input string by spaces
        let i = 0;
        let k = parseInt(msgArray[0]);
        let omega = msgArray[0];
        let res = "";
        let flag = 0;
        let buffer = "";
        let polnaya_zapis = "-";

        while (i < msgArray.length) {
            if (k < asd.length) {
                const letter = asd[k];

                if (flag !== 0) {
                    polnaya_zapis = buffer + letter;
                    asd.push(polnaya_zapis);
                }
                res += letter;
                buffer = letter;
                let abc = asd.length - 10
                let cba = asd.length - 11
                if (debug) {
                    addToDebugTable("decipherTable", k + " / " + letter + " / " + cba + ": " + polnaya_zapis + " / " + abc + ": " + buffer + "?");
                }
                flag = 1;
            }
            i += 1;
            if (i < msgArray.length) {
                k = parseInt(msgArray[i]);
            }
        }

        addToDebugTable("decipherTable", "Decipher Output: " + res);
    }

    function executeCipher() {
        const msg = document.getElementById("msgInput").value;
        const cipherTableBody = document.getElementById("cipherTableBody");
        cipherTableBody.innerHTML = "";

        const decipherTableBody = document.getElementById("decipherTableBody");
        decipherTableBody.innerHTML = "";

        if (msg.length === 0) {
            addToDebugTable("cipherTable", "Please enter a 'msg' value.");
        } else {
            const cipherResult = cipher(msg, true); // Set debug to true
            decipher(cipherResult, true); // Decipher and set debug to true
        }
    }
</script>
</body>
</html>
